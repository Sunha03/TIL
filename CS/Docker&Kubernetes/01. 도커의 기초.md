### 도커/쿠버네티스를 활용한 컨테이너 개발 실전 입문<br/>

현장에서 바로 활용할 수 있는 컨테이너 개발 기법과 실전 기술<br/>by. 야미다 아키노리 지음 / 심효섭 옮김

# Chapter 01. 도커의 기초

### 01. 도커란 무엇인가

```tex
▫️ 컨테이너형 가상화 기술을 구현하기 위한 상주 애플리케이션 + 이 애플리케이션을 조작하기 위한 명령행 도구로 구성되는 프로덕트(product)
```

+ 특징

  + 애플리케이션 배포에 특화되어 있음 → 애플리케이션 개발 및 운영을 컨테이너 중심으로 할 수 있음
  + 몇 줄짜리 구성 파일과 명령어 한 줄로 애플리케이션 or 미들웨어가 이미 갖춰진 테스트용 가상환경(도커 컨테이너)을 빠르게 구축할 수 있음
  + 오버헤드가 적어짐
  + 개발 환경 구축뿐만 아니라 개발 후 운영 환경에 대한 배포 or 애플리케이션 플랫폼으로 기능할 수 있음 → 기존 가상 머신보다 뛰어남
  + 이식성이 뛰어남 → 로컬 머신의 도커 환경에서 실행하던 컨테이너를 다른 서버에 있는 도커 환경에 배포 or 그 반대로도 가능함
  + 컨테이너 간 연동이 가능함
  + 클라우드 플랫폼을 지원함
  + 컨테이너를 쉽게 만들고 사용하고 버릴 수 있음
  + Dockerfile 코드를 기반으로 복제 및 배포가 이루어짐 → 재현성이 높음
  + 환경의 영향을 덜 받고 배포가 간편함

+ 도커가 적합하지 않은 경우

  + 좀 더 엄밀한 리눅스 계열 운영 체제의 동작이 요구되는 가상 환경을 구축해야 하는 경우
  + FreeBSD 같은 비리눅스 환경이 필요한 경우

+ 도커의 기본 개념

  + 도커 → 애플리케이션 배포에 특화됨 + 컨테이너 활용에 유리한 생태계가 잘 갖춰짐

  + 도커 컨테이너(Container)

    ```tex
    ▫️ 가상 운영 체제 → 운영 체제(인프라)와 애플리케이션을 함께 담은 상자 같은 개념
    ```

  + 컨테이너형 가상화 기술 → 가상화 소프트웨어 없이도 운영 체제의 리소스를 격리해 가상 운영체제를 만듦

  + 호스트 운영 체제 가상화 → 운영 체제 위에서 가상화 소프트웨어를 사용해 하드웨어를 애뮬레이션하는 방법. 게스트 운영 체제를 만드는 방식.

    + 컨테이너형 가상화 기술보다 구조적으로 오버헤드가 큼

    <img src="https://user-images.githubusercontent.com/33214969/148767603-9764c5fe-b8e9-48da-b2b8-1d0a47368e8c.jpeg" alt="IMG_08BA965B43A1-1.jpeg" width="50%;" />

  + 도커 vs LXC

    + 호스트 운영 체제의 영향을 받지 않는 실행 환경(Docker Engine을 이용한 실행 환경 표준화) → 도커는 컨테이너에 애플리케이션 실행 환경이 함께 배포되는 방식이라 운영 체제의 영향을 강하게 받지 않음
    + DSL(Dockerfile)을 이용한 컨테이너 구성 및 애플리케이션 배포 정의
    + 이미지 버전 관리
    + 레이어 구조를 갖는 이미지 포맷 → 차분 빌드가 가능함
    + 도커 레지스트리 → 이미지 저장 서버 역할을 함
    + 프로그램 가능한 다양한 기능의 API

    + 도커는 리눅스 커널에서 컨테이너를 구현하는 Linux namespaces or cgroups 등의 API를 직접 실행하는 "libcontainer" 라이브러리를 개발함

    <img src="https://user-images.githubusercontent.com/33214969/148767773-c95966a6-4957-46ca-a07b-6a62be6b7db5.jpeg" alt="IMG_392650F119AA-1.jpeg" width="50%;" />

+ 도커 스타일 체험하기

  1. 셀 스크립트 파일("helloworld") 생성 → 애플리케이션 역할

  2. 셀 스크립트와 같은 폴더에 Dockerfile 작성

     > + FROM절 : 컨테이너의 원형(틀) 역할을 할 도커 이미지(운영 체제)를 정의
     > + COPY절
     > + RUN절 : 도커 컨테이너 안에서 어떤 명령을 수행하기 위한 것
     > + CMD절 : 완성된 이미지를 도커 컨테이너로 실행하기 전에 먼저 실행할 명령을 정의

     

     <img src="https://user-images.githubusercontent.com/33214969/148768126-7f6d041e-8840-4edc-b361-962660632962.jpeg" alt="IMG_DFBEC8C4B1E6-1.jpeg" width="70%;" />

  3. 이 Dockerfile을 사용해 이미지 빌드 및 실행 → Dockfile이 있는 폴더에서 docker image build 명령 실행

     <img src="https://user-images.githubusercontent.com/33214969/148768236-6c9d65de-0792-45c5-a5e4-73ce7221c9cf.jpeg" alt="IMG_07AAAAB1430D-1.jpeg" width="50%;" />

  4. 도커 컨테이너를 실행 → 빌드가 끝난 후 docker container fun 명령 실행

     <img src="https://user-images.githubusercontent.com/33214969/148768317-b920ecc7-c6d1-421a-b237-13fbcd62e737.jpeg" alt="IMG_4CFAA3287A2C-1.jpeg" width="50%;" />

  + 도커 이미지 빌드

    ```tex
    ▫️ Dockerfile or 애플리케이션 실행 파일을 사용해서 도커 컨테이너의 원형이 될 이미지를 만드는 과정 (위의 2번 과정)
    ```